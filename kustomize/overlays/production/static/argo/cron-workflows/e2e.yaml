apiVersion: argoproj.io/v1alpha1
kind: CronWorkflow
metadata:
  name: e2e
  namespace: static
spec:
  concurrencyPolicy: Allow
  schedule: 0 */3 * * *
  startingDeadlineSeconds: 0
  timezone: America/New_York
  workflowSpec:
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
            - matchExpressions:
                - key: tenlastic.com/low-priority
                  operator: Exists
    archiveLogs: true
    artifactGC:
      serviceAccountName: argo-workflows
      strategy: OnWorkflowDeletion
    entrypoint: e2e
    podGC:
      strategy: OnWorkflowSuccess
    serviceAccountName: argo-workflows
    ttlStrategy:
      secondsAfterSuccess: 86400
    templates:
      - name: e2e
        container:
          image: tenlastic/e2e:0.0.395
          envFrom:
            - secretRef:
                name: e2e
          imagePullPolicy: IfNotPresent
          resources:
            limits:
              cpu: 1000m
              memory: 1G
            requests:
              cpu: 500m
              memory: 1G
        outputs:
          artifacts:
            - name: puppeteer
              path: /usr/src/test-results/puppeteer/
